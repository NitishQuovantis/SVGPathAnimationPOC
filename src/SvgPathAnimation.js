import React, {Component} from 'react';
import {SafeAreaView, View, Animated} from 'react-native';
import Svg, {Path} from 'react-native-svg';
import {interpolatePath} from 'd3-interpolate-path';

const AnimatedPath = Animated.createAnimatedComponent(Path);

export default class SvgPathAnimation extends Component {
  // Path 1 : "M0,0 L10,10"
  // Path 2 : 'M10,10 L20,20 L30,30'

  constructor(props) {
    super(props);
    this.path1 =
      'M476.002,70.525H253.667c-1.259,-5.716 -1.703,-10.977 -0.715,-15.524h223.049c5.523,0 10,-4.477 10,-10v-35c0,-2.691 -1.085,-5.269 -3.01,-7.151c-1.925,-1.882 -4.535,-2.909 -7.217,-2.847l-440,10c-5.433,0.123 -9.773,4.563 -9.773,9.998v25c0,5.523 4.477,10 10,10H75.68c-0.571,5.07 -0.259,10.265 0.626,15.526H36.001c-5.523,0 -10,4.477 -10,10v25c0,5.434 4.34,9.874 9.773,9.998l54.853,1.247c5.289,18.021 5.671,31.2 -5.664,42.752c-28.271,28.812 -18.222,61.995 -10.148,88.658c2.588,8.547 5.076,16.766 6.368,24.46H54.648c-5.523,0 -10,4.477 -10,10c0,37.12 9.764,73.635 28.235,105.597c16.959,29.346 40.89,54.344 69.43,72.595v41.169c0,5.523 4.477,10 10,10h207.378c5.523,0 10,-4.477 10,-10v-41.17c28.541,-18.251 52.47,-43.249 69.43,-72.594c18.472,-31.962 28.235,-68.477 28.235,-105.597c0,-5.523 -4.477,-10 -10,-10h-8.404c0.684,-3.62 1.049,-7.312 1.049,-11.069c0,-32.67 -26.58,-59.25 -59.25,-59.25c-21.459,0 -40.29,11.468 -50.688,28.597c-5.155,-1.708 -10.579,-2.598 -16.063,-2.598c-25.856,0 -47.264,19.345 -50.548,44.319H258.39c-1.348,-10.124 -4.433,-20.318 -7.443,-30.257c-7.88,-26.026 -14.686,-48.503 5.282,-68.854c15.875,-16.179 16.791,-34.832 13.056,-52.7l206.489,4.693c0.076,0.001 0.151,0.002 0.228,0.002c2.609,0 5.12,-1.021 6.99,-2.849c1.925,-1.881 3.01,-4.46 3.01,-7.151v-35C486.002,75.002 481.525,70.525 476.002,70.525zM46.001,95.751v-5.224h35.69c0.69,2.031 1.404,4.06 2.125,6.084L46.001,95.751zM89.353,35.001c-0.012,0 -0.023,0 -0.035,0H46.001v-5.224l420,-9.546v14.77H246.344c-0.012,0 -0.023,0 -0.035,0h-39.215c-0.01,0 -0.02,0 -0.029,0h-39.219c-0.01,0 -0.02,0 -0.029,0h-39.216c-0.012,0 -0.023,0 -0.035,0H89.353zM192.558,248.18c2.588,8.548 5.076,16.767 6.367,24.461h-19.03c-1.348,-10.124 -4.433,-20.318 -7.443,-30.257c-7.881,-26.026 -14.687,-48.502 5.282,-68.854c24.463,-24.932 13.418,-55.738 4.542,-80.492c-5.13,-14.307 -10.015,-27.938 -7.819,-38.037h18.967c-1.621,14.379 3.889,29.771 9.273,44.787c9.761,27.225 14.633,44.831 0.008,59.735C174.437,188.335 184.484,221.518 192.558,248.18zM153.31,248.182c2.588,8.547 5.076,16.766 6.367,24.46h-19.03c-1.348,-10.124 -4.433,-20.318 -7.443,-30.257c-7.881,-26.026 -14.687,-48.502 5.282,-68.854c24.463,-24.932 13.417,-55.738 4.542,-80.491c-5.13,-14.307 -10.015,-27.939 -7.819,-38.038h18.967c-1.621,14.379 3.89,29.771 9.273,44.788c9.761,27.225 14.633,44.83 0.009,59.734C135.188,188.336 145.236,221.519 153.31,248.182zM99.239,173.531c20.894,-21.295 15.881,-46.873 8.444,-69.308c-0.06,-0.211 -0.134,-0.416 -0.207,-0.622c-1.208,-3.614 -2.471,-7.147 -3.696,-10.562C98.65,78.732 93.765,65.1 95.961,55.001h18.967c-1.621,14.379 3.89,29.771 9.273,44.788c9.761,27.224 14.632,44.83 0.009,59.734c-28.27,28.812 -18.222,61.995 -10.148,88.658c2.588,8.547 5.076,16.766 6.367,24.46h-19.03c-1.347,-10.123 -4.433,-20.317 -7.443,-30.256C86.075,216.359 79.269,193.883 99.239,173.531zM390.751,222.323c21.643,0 39.25,17.607 39.25,39.25c0,3.799 -0.538,7.501 -1.587,11.069h-75.326c-1.049,-3.568 -1.587,-7.271 -1.587,-11.069C351.501,239.93 369.109,222.323 390.751,222.323zM324.001,248.322c2.968,0 5.903,0.438 8.72,1.263c-0.799,3.873 -1.22,7.882 -1.22,11.988c0,3.756 0.365,7.449 1.049,11.069h-38.816C296.798,258.75 309.202,248.322 324.001,248.322zM283.114,292.642c0.003,0 0.007,0 0.01,0c0.004,0 0.008,0 0.012,0h63.061c0.012,0 0.023,0.002 0.035,0.002c0.015,0 0.03,-0.002 0.045,-0.002h100.825c-3.235,63.753 -37.327,120.817 -92.585,154.071c-3.194,1.922 -4.993,5.415 -4.826,9.021v36.269H162.313V455.87c0.216,-3.654 -1.593,-7.211 -4.827,-9.157c-55.258,-33.254 -89.349,-90.318 -92.585,-154.071H283.114zM241.953,159.524c-28.269,28.812 -18.221,61.995 -10.147,88.657c2.588,8.548 5.076,16.767 6.367,24.461h-19.031c-1.348,-10.124 -4.433,-20.318 -7.443,-30.257c-7.88,-26.026 -14.686,-48.503 5.282,-68.854c24.464,-24.932 13.418,-55.739 4.543,-80.493c-5.13,-14.307 -10.015,-27.938 -7.819,-38.037h18.967c-1.029,9.134 0.816,18.677 3.684,28.273c0.036,0.126 0.072,0.252 0.113,0.376c1.624,5.386 3.558,10.786 5.477,16.139C251.706,127.013 256.578,144.619 241.953,159.524zM466.001,105.297l-202.521,-4.603c-0.9,-2.604 -1.815,-5.162 -2.709,-7.655c-0.301,-0.84 -0.601,-1.677 -0.899,-2.512h206.129V105.297z';
    this.path2 =
      'M202.856,254.873h-8c-2.488,0 -4,-1.392 -4,-2c0,-0.608 1.512,-2 4,-2h20c4.418,0 8,-3.582 8,-8s-3.582,-8 -8,-8h-8c0,-4.418 -3.582,-8 -8,-8s-8,3.582 -8,8v0.36c-8.873,1.253 -15.595,8.648 -16,17.6c0.573,10.489 9.507,18.548 20,18.04h8c2.488,0 4,1.392 4,2c0,0.608 -1.512,2 -4,2h-20c-4.418,0 -8,3.582 -8,8s3.582,8 8,8h8c0,4.418 3.582,8 8,8s8,-3.582 8,-8v-0.36c8.873,-1.253 15.595,-8.648 16,-17.6C222.283,262.424 213.349,254.365 202.856,254.873z';
    this.pathAnimation = new Animated.Value(0);
  }

  componentDidMount() {
    const pathInterpolator = interpolatePath(this.path1, this.path2);

    this.pathAnimation.addListener(({value}) => {
      const path = pathInterpolator(value);
      console.log(('value', path));
      if (this._pathRef) {
        this._pathRef.setNativeProps({d: path});
      }
    });
    setTimeout(() => {
      this.startAnimation();
    }, 1000);
  }

  startAnimation = () => {
    Animated.timing(this.pathAnimation, {
      toValue: this.startAnimation.value === 1 ? 0 : 1,
      duration: 10000,
    }).start(() => {
      this.startAnimation();
    });
  };

  render() {
    return (
      <View>
        <SafeAreaView />
        <Svg width="200" height="200">
          <AnimatedPath
            d={this.path2}
            stroke="red"
            ref={ref => {
              this._pathRef = ref;
            }}
          />
        </Svg>
      </View>
    );
  }
}
